#!/bin/sh
COL_WHT="\033[1;37m";
COL_RED="\033[1;31m";
COL_YEL="\033[1;33m";
COL_GRN="\033[01;32m";
COL_CLR="\033[00m";

if [ -z "$1" ]; then
echo "Choose Assessment:  1 ";
	echo -n "${COL_WHT}Assmnt#:${COL_CLR} ";
	read assi;
else
	assi=$1;
fi;

echo "${COL_YEL}Chosen: ${COL_WHT}${assi}${COL_CLR}";

if [ "$assi" -eq "1" ]; then
	echo "${COL_WHT}Assessment 1 chosen${COL_CLR}";
	RPDI="../docs/initial-report";
	TXFI="${RPDI}/initial-report.tex";
	WCFI="${RPDI}/wc.tex";
	XTRA="${RPDI}/risk-register.tex";
else
	echo "${COL_RED}Invalid! ${COL_WHT}Please choose another selection${COL_CLR}";
	exit 1;
fi

if [ -f "$WCFI" ]; then
X=100;
else
touch $WCFI
fi


echo "${COL_YEL}Compiling Latex${COL_CLR}";
rubber --pdf ${TXFI}

echo -n "${COL_YEL}Computing Word Count: ${COL_CLR}";
#WC=`(cd $RPDI && detex ../$TXFI) | wc -w | tr -d ' '`;
# this needs to be on a seperate line to
kxWC=`./tools/texcount/texcount.pl -v0 -brief -nosub -noinc -total $TXFI $XTRA | grep Total | sed -e 's/+/\n/g' | awk '{ print $1 } '`;
# this line.
WC=`echo $kxWC | awk ' { print $1 } ' | tr -d ' '`;
echo "${COL_GRN}${WC}${COL_CLR}";
echo "$WC" > $WCFI

echo "${COL_YEL}Compiling Latex${COL_CLR}";
rubber --pdf ${TXFI}


echo "${COL_GRN} - OK - ${COL_CLR}";
